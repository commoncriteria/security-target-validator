<?xml version="1.0" encoding="UTF-8"?>

<!-- Grab all the selectablel sizes -->
<!-- -->


<st xmlns="https://niap-ccevs.org/cc/v1"
    xmlns:h="http://www.w3.org/1999/xhtml"
    >
  <package>
    <git>
      <url>https://github.com/commoncriteria/ssh</url>
      <branch>release-1.0</branch>
      <commit>95832af91e6c8d83e02ec7690c8b35b6357397b1</commit>
    </git>
    <f-component cc-id="fcs_ssh_ext.1" name="SSH Protocol">
      <f-element id="fcs-ssh-ext-1e1">
	<title>The TOE shall implement <h:i>SSH</h:i> acting as a
	<selectables>
	  <selectable id="ssh-client">client</selectable>
	  <selectable id="ssh-server">server</selectable>
	  </selectables> in accordance with
	  that complies with RFCs 4251, 4252, 4253, 4254,
	  <selectables>
	    <selectable id="sel-rfc4256">4256</selectable>
	    <selectable id="sel-rfc4344">4344</selectable>
	    <selectable id="sel-rfc5647">5647</selectable>
	    <selectable id="sel-rfc5656">5656</selectable>
	    <selectable id="sel-rfc6187">6187</selectable>
	    <selectable id="sel-rfc6668">6668</selectable>
	    <selectable id="sel-rfc8268">8268</selectable>
	    <selectable id="sel-rfc8308">8308</selectable>
	    <selectable id="sel-rfc8332">8332</selectable>
	    <selectable id="sel-rfc8709">8709</selectable>
	    <selectable id="sel-rfc8731">8731</selectable>
	    </selectables> and [<h:i>no other standard</h:i>].
	</title>


      </f-element>
      <f-element id="fcs-ssh-ext-1e2">
	<title>
	  The TSF shall ensure that the SSH protocol implementation supports the following authentication methods: 
	  <selectables linebreak="yes">
	    <selectable>“password” (RFC 4252)</selectable>
	    <selectable>“keyboard-interactive” (RFC 4256)</selectable> 
	    <selectable>“publickey” (RFC 4252): 
	    <selectables linebreak="yes">
	      <selectable>ssh-rsa (RFC 4253)</selectable>  
	      <selectable>rsa-sha2-256 (RFC 8332)</selectable> 
	      <selectable>rsa-sha2-512 (RFC 8332)</selectable> 
	      <selectable>ecdsa-sha2-nistp256 (RFC 5656)</selectable>  
	      <selectable>ecdsa-sha2-nistp384 (RFC 5656)</selectable> 
	      <selectable>ecdsa-sha2-nistp521 (RFC 5656)</selectable>
	      <selectable>ssh-ed25519 (RFC 8709)</selectable>
	      <selectable>ssh-ed448 (RFC 8709)</selectable>
	      <selectable>x509v3-ecdsa-sha2-nistp256 (RFC 6187)</selectable> 
	      <selectable>x509v3-ecdsa-sha2-nistp384 (RFC 6187)</selectable> 
	      <selectable>x509v3-ecdsa-sha2-nistp521 (RFC 6187)</selectable>
	      <selectable>x509v3-rsa2048-sha256  (RFC 6187)</selectable> 
	    </selectables>
	    </selectable>
	    </selectables> and no other methods.
	</title>


      </f-element>
      <f-element id="fcs-ssh-ext-1e3">
	<title>
	  The TSF shall ensure that, as described in RFC 4253, packets greater than 
	  <assignable>number of bytes between 35,000 and 1 GB (inclusive)</assignable>
	  in an SSH transport connection are dropped.
	</title>


      </f-element>
      <f-element id="fcs-ssh-ext-1e4">
	<title>
	  The TSF shall protect data in transit from unauthorised disclosure using the following mechanisms: 
	  <selectables linebreak="yes">
	    <selectable>aes128-ctr (RFC 4344)</selectable>  
	    <selectable>aes256-ctr (RFC 4344)</selectable>
	    <selectable>aes128-cbc (RFC 4253)</selectable>
	    <selectable>aes256-cbc (RFC 4253)</selectable>
	    <selectable>AEAD_AES_128_GCM (RFC 5647)</selectable> 
	    <selectable>AEAD_AES_256_GCM (RFC 5647)</selectable> 
	    <selectable>aes128-gcm@openssh.com (RFC 5647)</selectable> 
	    <selectable>aes256-gcm@openssh.com (RFC 5647)</selectable>
	    </selectables> and no other mechanisms.
	</title>


      </f-element>
      <f-element id="fcs-ssh-ext-1e5">
	<title>
	  The TSF shall protect data in transit from modification, deletion, and insertion using: 
	  <selectables linebreak="yes">
	    <!--						<selectable>hmac-sha1 (RFC 4253)</selectable>  -->
	    <selectable>hmac-sha2-256 (RFC 6668)</selectable> 
	    <selectable>hmac-sha2-512 (RFC 6668)</selectable>
	    <selectable>AEAD_AES_128_GCM (RFC 5647)</selectable>
	    <selectable>AEAD_AES_256_GCM (RFC 5647)</selectable>
	    <selectable>implicit </selectable>
	    </selectables> and no other mechanisms.
	</title>


      </f-element>
      <f-element id="fcs-ssh-ext-1e6">
	<title>
	  The TSF shall establish a shared secret with its peer using: 
	  <selectables linebreak="yes">
	    <!--						<selectable>diffie-hellman-group14-sha1 (RFC 4253)</selectable>  -->
	    <selectable>diffie-hellman-group14-sha256 (RFC 8268)</selectable>  
	    <selectable>diffie-hellman-group15-sha512 (RFC 8268)</selectable>  
	    <selectable>diffie-hellman-group16-sha512 (RFC 8268)</selectable>  
	    <selectable>diffie-hellman-group17-sha512 (RFC 8268)</selectable>  
	    <selectable>diffie-hellman-group18-sha512 (RFC 8268)</selectable> 
	    <selectable>ecdh-sha2-nistp256 (RFC 5656)</selectable> 
	    <selectable>ecdh-sha2-nistp384 (RFC 5656)</selectable>
	    <selectable>ecdh-sha2-nistp521 (RFC 5656)</selectable>  
	    <selectable>curve25519-sha256 (RFC 8731)</selectable>
	    <selectable>curve448-sha512 (RFC 8731)</selectable> 
	    </selectables> and no other mechanisms.
	</title>

      </f-element>
      <f-element id="fcs-ssh-ext-1e7">
	<title>
	  The TSF shall use <h:i>SSH KDF</h:i> as defined in 
	  <selectables linebreak="yes">
	    <selectable>RFC 4253 (Section 7.2)</selectable> 
	    <selectable> RFC 5656 (Section 4) </selectable>
	  </selectables>
	  to derive the following cryptographic keys from a shared secret: <h:i>session keys</h:i>.
	</title>


      </f-element>
      <f-element id="fcs-ssh-ext-1e8">
	<title>
	  The TSF shall ensure that 
	  <selectables linebreak="yes">
	    <selectable>a rekey of the session keys</selectable> 	 
	    <selectable>connection termination</selectable>
	  </selectables>
	  occurs when any of the following thresholds are met: 
	  <h:ul>
	    <h:li>one hour connection time</h:li>
	    <h:li>no more than one gigabyte of transmitted data, or</h:li>
	    <h:li>no more than one gigabyte of received data.</h:li>
	  </h:ul>
	</title>


      </f-element>
      <audit-event type="optional">
	<audit-event-descr>Failure to establish SSH connection</audit-event-descr>
	<audit-event-info>Reason for failure.</audit-event-info>
	<audit-event-info type="optional">Non-TOE endpoint of attempted connection (IP Address)</audit-event-info>
      </audit-event>
      <audit-event type="optional">
	<audit-event-descr>Establishment of SSH connection</audit-event-descr>
	<audit-event-info type="optional">Non-TOE endpoint of connection (IP Address)</audit-event-info>
      </audit-event>
      <audit-event type="optional">
	<audit-event-descr>Termination of SSH connection session</audit-event-descr>
	<audit-event-info type="optional">Non-TOE endpoint of connection (IP Address)</audit-event-info>
      </audit-event>
      <audit-event type="optional">
	<audit-event-descr>Dropping of packet(s) outside defined size limits</audit-event-descr>
	<audit-event-info type="optional">Packet size</audit-event-info>
      </audit-event>
    </f-component>

    <!-- 			-->
    <!-- FCS_SSHC_EXT.1	-->
    <!--			-->	
    <f-component cc-id="fcs_sshc_ext.1" name="SSH Protocol - Client" status="sel-based">
      <depends on="ssh-client"/>       
      <f-element id="fcs-sshc-ext-1e1">
	<title>The TSF shall authenticate its peer (SSH server) using: 
	<selectables linebreak="yes">
	  <selectable>using a local database by associating each host name with a public key corresponding to the following list:
	  <selectables linebreak="yes">
	    <selectable>ssh-rsa (RFC 4253)</selectable> 
	    <selectable>rsa-sha2-256 (RFC 8332)</selectable> 
	    <selectable>rsa-sha2-512 (RFC 8332)</selectable>
	    <selectable>ecdsa-sha2-nistp256 (RFC 5656)</selectable>
	    <selectable>ecdsa-sha2-nistp384 (RFC 5656)</selectable>
	    <selectable>ecdsa-sha2-nistp521 (RFC 5656)</selectable>
	    <selectable>ssh-ed25519 (RFC 8709)</selectable>
	    <selectable>ssh-ed448 (RFC 8709)</selectable>
	  </selectables>
	  </selectable>
	  <selectable>a list of trusted certification authorities when the public key is in the following formats:
	  <selectables linebreak="yes">
	    <selectable>x509v3-ecdsa-sha2-nistp256 (RFC 6187)</selectable>  
	    <selectable>x509v3-ecdsa-sha2-nistp384 (RFC 6187)</selectable>  
	    <selectable>x509v3-ecdsa-sha2-nistp521 (RFC 6187)</selectable>  
	    <selectable>x509v3-rsa2048-sha256  (RFC 6187)</selectable>
	  </selectables>
	  </selectable>
	</selectables>
	as described in RFC 4251 section 4.1.
	</title>


      </f-element>
      <audit-event/>
    </f-component>

    <!-- 			-->
    <!-- FCS_SSHS_EXT.1	-->
    <!--			-->	
    <f-component cc-id="fcs_sshs_ext.1" name="SSH Protocol - Server" status="sel-based">
      <depends on="ssh-server"/>
      <f-element id="fcs-sshs-ext-1e1"> 
	<title>The TSF shall authenticate itself to its peer (SSH Client) using:
	<selectables linebreak="yes">
	  <selectable>ssh-rsa (RFC 4253)</selectable>
	  <selectable>rsa-sha2-256 (RFC 8332)</selectable>
	  <selectable>rsa-sha2-512 (RFC 8332)</selectable>
	  <selectable>ecdsa-sha2-nistp256 (RFC 5656)</selectable> 
	  <selectable>ecdsa-sha2-nistp384 (RFC 5656)</selectable>
	  <selectable>ecdsa-sha2-nistp521 (RFC 5656)</selectable> 
	  <selectable>x509v3-ecdsa-sha2-nistp256 (RFC 6187)</selectable> 
	  <selectable>x509v3-ecdsa-sha2-nistp384 (RFC 6187)</selectable> 
	  <selectable>x509v3-ecdsa-sha2-nistp521 (RFC 6187)</selectable>
	  <selectable>x509v3-rsa2048-sha256  (RFC 6187)</selectable>
	  <selectable>ssh-ed25519 (RFC 8709)</selectable>
	  <selectable>ssh-ed448 (RFC 8709)</selectable>
	  </selectables>.
	</title>


      </f-element>
    </f-component>    
  </package>

  <package>
    <git>
      <url>https://github.com/commoncriteria/tls</url>
      <branch>release-1.1</branch>
      <commit>53aaae9ea56c98e49b767ca19b2b6058206bab25</commit>
    </git>

    <f-component cc-id="fcs_tls_ext.1" name="TLS Protocol">
      <f-element id="f-type">
	<title>The product shall implement
        <selectables linebreak="yes">
          <selectable id="tlsc_impl">TLS as a client</selectable>
          <selectable id="tlss_impl">TLS as a server</selectable>
          <selectable id="dtlsc_impl">DTLS as a client</selectable>
          <selectable id="dtlss_impl">DTLS as a server</selectable>
          </selectables>.
        </title>
      </f-element>
    </f-component>
    <f-component cc-id="fcs_tlsc_ext.1" name="TLS Client Protocol" status="sel-based">
      <depends on="tlsc_impl"/>
      <f-element id="f-tlsc-version">
        <title> The product shall implement TLS 1.2 (RFC 5246) and
        <selectables>
          </selectables> as a client that supports the cipher suites
          <selectables linebreak="yes">
            <selectable>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</selectable>
            <selectable>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</selectable>
            <selectable>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</selectable>
            <selectable>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</selectable>
            <selectable>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</selectable>
            <selectable>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</selectable>
            <selectable>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</selectable>
            <selectable id="tecdhe1">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</selectable>
            <selectable id="tecdhe2">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</selectable>
            <selectable id="tecdhe3">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</selectable>
            <selectable id="tecdhe4">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</selectable>
            <selectable id="tecdhe5">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</selectable>
            <selectable id="tecdhe6">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</selectable>
            <selectable id="tecdhe7">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</selectable>
            <selectable id="tecdhe8">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</selectable>
          </selectables>
          and also supports functionality for 
          <selectables linebreak="yes">
            <selectable id="tlsc_mutual_auth">mutual authentication</selectable>
            <selectable id="tlsc_reneg">session renegotiation</selectable>
            </selectables>.
        </title>
      </f-element>
      <f-element id="f-tlsc-presented-reference-ids">
        <title> The product shall verify that the presented identifier matches the reference
        identifier according to RFC 6125. </title>
      </f-element>

      <f-element id="f-tlsc-handle-bad-cert">
        <title>The product shall not establish a trusted channel if the
        server certificate is invalid
        <selectables linebreak="yes">
          <selectable exclusive="yes" id="s-tlsc-no-excep">with no exceptions</selectable>
          </selectables>.
	</title>
      </f-element>
    </f-component>
    <f-component cc-id="fcs_tlsc_ext.2" name="TLS Client Support for Mutual Authentication" status="sel-based">
      <depends on="tlsc_mutual_auth"/>
      <f-element id="f-tlsc-mutual-auth">
        <title>The product shall support mutual authentication using X.509v3 certificates.</title>
      </f-element>
    </f-component>


    <f-component cc-id="fcs_tlsc_ext.3" name="TLS Client Support for Signature Algorithms Extension" status="objective">
      <f-element id="f-tlsc-sig-algo">
        <title> The product shall present the signature_algorithms extension in the Client Hello with
        the supported_signature_algorithms value containing the following hash algorithms: <selectables>
        <selectable>SHA256</selectable>
        <selectable>SHA384</selectable>
        <selectable>SHA512</selectable>
        </selectables> and no other hash algorithms. </title>
      </f-element>
    </f-component>

    <f-component cc-id="fcs_tlsc_ext.4" name="TLS Client Support for Renegotiation" status="sel-based">
      <depends on="tlsc_reneg"/>
      <f-element id="f-tlsc-reneg">
        <title> The product shall support secure renegotiation through use
        of the “renegotiation_info” TLS extension in accordance with RFC 5746. </title>
      </f-element>
    </f-component>
    <f-component cc-id="fcs_tlsc_ext.5" name="TLS Client Support for Supported Groups Extension" status="sel-based">
      <depends on="tecdhe1" on1="tecdhe2" on2="tecdhe3" on3="tecdhe4" on4="tecdhe5" on5="tecdhe6" on6="tecdhe7" on7="tecdhe8"/>
      <depends on="decdhe1" on2="decdhe2" on3="decdhe3" on4="decdhe4" on5="decdhe5" on6="decdhe6" on7="decdhe7" on8="decdhe8"/>
      <f-element id="f-tlsc-groups-ext"><!-- Was 1.4 -->
        <!-- TODO: IDs for ECC DHE curves -->
        <title> The product shall present the Supported Groups Extension in the Client Hello
        with the supported groups <selectables linebreak="yes">
        <selectable>secp256r1</selectable>
        <selectable>secp384r1</selectable>
        <selectable>secp521r1</selectable>
        <selectable>ffdhe2048(256)</selectable>
        <selectable>ffdhe3072(257)</selectable>
        <selectable>ffdhe4096(258)</selectable>
        <selectable>ffdhe6144(259)</selectable>
        <selectable>ffdhe8192(260)</selectable>
        </selectables>.
        </title>
      </f-element>
    </f-component>
    <f-component cc-id="fcs_tlss_ext.1" name="TLS Server Protocol" status="sel-based">
      <depends on="tlss_impl"/>
      <f-element id="f-tlss-version">
        <title> The product shall implement TLS 1.2 (RFC 5246) and
        <selectables>
          <selectable exclusive="yes">no earlier TLS versions</selectable>
        </selectables>
        as a server that supports the cipher suites
        <selectables linebreak="yes">
          <selectable>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</selectable>
          <selectable>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</selectable>
          <selectable>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</selectable>
          <selectable>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</selectable>
          <selectable>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</selectable>
          <selectable>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</selectable>
          <selectable>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</selectable>
          <selectable>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</selectable>
          </selectables> and no other cipher suites,
          and also supports functionality for
          <selectables linebreak="yes">
            <selectable id="tlss_mutual_auth">mutual authentication</selectable>
            <selectable id="tlss_reneg">session renegotiation</selectable>
            </selectables>.
        </title>
      </f-element>
      <f-element id="f-tlss-bad-version">
        <title>The product shall deny connections from clients requesting
        SSL 2.0, SSL 3.0, TLS 1.0 and
        <selectables>
          <selectable exclusive="yes">none</selectable>
          </selectables>.
        </title>
      </f-element>
      <f-element id="f-tlss-key-size">
        <title>The product shall perform key establishment for TLS using
        <selectables>
          <selectable>RSA with size
          <selectables>
            <selectable>2048 bits</selectable>
            <selectable>3072 bits</selectable>
            <selectable>4096 bits</selectable>
          </selectables>
          </selectable>
          <selectable>Diffie-Hellman parameters with size
          <selectables>
            <selectable>2048 bits</selectable>
            <selectable>3072 bits</selectable>
            <selectable>4096 bits</selectable>
          </selectables>
          </selectable>
          <selectable>Diffie-Hellman groups
          <selectables>
            <selectable>ffdhe2048</selectable>
            <selectable>ffdhe3072</selectable>
            <selectable>ffdhe4096</selectable>
            <selectable>ffdhe6144</selectable>
            <selectable>ffdhe8192</selectable>
            <selectable>no other groups</selectable>
          </selectables>
          </selectable>
          </selectables>.
        </title>
      </f-element>
    </f-component>
    <f-component cc-id="fcs_tlss_ext.2" name="TLS Server Support for Mutual Authentication" status="sel-based">
      <depends on="tlss_mutual_auth"/>
      <f-element id="f-tlss-mutual-auth">
        <title>The product shall support authentication of
        TLS clients using X.509v3 certificates.
        </title>
      </f-element>
      <f-element id="f-tlss-bad-cert">
        <title>The product shall not establish a trusted channel
        if the client certificate is invalid.
        </title>
      </f-element>
      <f-element id="f-tlss-bad-dn-san">
        <title>The product shall not establish a trusted channel if
        the Distinguished Name (DN) or Subject Alternative Name (SAN)
        contained in a certificate does not match one of the expected identifiers
        for the client.
        </title>
      </f-element>
    </f-component>
    <f-component cc-id="fcs_tlss_ext.3" name="TLS Server Support for Signature Algorithms Extension" status="objective">
      <f-element id="f-tlss-hashalgos">
        <title>The product shall present the HashAlgorithm
        enumeration in supported_signature_algorithms in the
        Certificate Request with the following hash algorithms:
	<selectables>
	  <selectable>SHA256</selectable>
	  <selectable>SHA384</selectable>
	  <selectable>SHA512</selectable>
	  </selectables> and no other hash algorithms.
        </title>
      </f-element>
    </f-component>

    <f-component cc-id="fcs_tlss_ext.4" name="TLS Server Support for Renegotiation" status="sel-based">
      <depends on="tlss_reneg"/>
      <f-element id="f-tlss-support-reneg">
        <title>The product shall support the "renegotiation_info" TLS extension
        in accordance with RFC 5746.
        </title>
      </f-element>
      <f-element id="f-tlss-include-reneg">
        <title>The product shall include the renegotiation_info extension in
        ServerHello messages.
        </title>
      </f-element>
    </f-component>

    <f-component cc-id="fcs_dtlsc_ext.1" name="DTLS Client Protocol" status="sel-based">
      <depends on="dtlsc_impl"/>
      <f-element id="f-dtlsc-version">
	<title>The product shall implement DTLS 1.2 (RFC 6347) and
	<selectables>
          <selectable>DTLS 1.0 (RFC 4347)</selectable>
	  </selectables> as a client that supports the cipher suites
	  <selectables linebreak="yes">
	    <selectable>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</selectable>
	    <selectable>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</selectable>
	    <selectable>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</selectable>
	    <selectable>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</selectable>
	    <selectable>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</selectable>
	    <selectable>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</selectable>
	    <selectable>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</selectable>
	    <selectable id="decdhe1">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</selectable>
	    <selectable id="decdhe2">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</selectable>
	    <selectable id="decdhe3">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</selectable>
	    <selectable id="decdhe4">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</selectable>
	    <selectable id="decdhe5">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</selectable>
	    <selectable id="decdhe6">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</selectable>
	    <selectable id="decdhe7">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</selectable>
	    <selectable id="decdhe8">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</selectable>
	  </selectables>
	  and also supports functionality for 
	  <selectables linebreak="yes">
            <selectable id="dtlsc_mutual_auth">mutual authentication</selectable>
	    </selectables>.
	</title>
      </f-element>

      <f-element id="f-dtlsc-pres-ids">
	<title> The product shall verify that the presented identifier matches the reference
        identifier according to RFC 6125. </title>
      </f-element>

      <f-element id="f-dtlsc-bad-cert">
	<title>The product shall not establish a trusted channel if the
        server certificate is invalid
        <selectables>
          <selectable>except when override is authorized</selectable>
	  </selectables>.
	</title>
      </f-element>
      <f-element id="f-dtlsc-bad-mac-decrypt">
	<title>The product shall
	<selectables>
	  <selectable>terminate the DTLS session</selectable>
	  <selectable>silently discard the record</selectable>
	</selectables>
	if a message received contains an invalid MAC or if decryption fails in the case of GCM and other
	AEAD ciphersuites.
	</title>
      </f-element>
    </f-component>
    <f-component cc-id="fcs_dtlsc_ext.2" name="DTLS Client Support for Mutual Authentication" status="sel-based">
      <depends on="dtlsc_mutual_auth"/>
      <f-element id="f-dtlsc-mut-auth">
        <title>
          The product shall support mutual authentication using X.509v3 certificates.
        </title>
      </f-element>
    </f-component>
    <f-component cc-id="fcs_dtlss_ext.1" name="DTLS Server Protocol" status="sel-based">
      <depends on="dtlss_impl"/>
      <f-element id="f-dtlss-version">
	<title>The product shall implement DTLS 1.2 (RFC 6347) and
	<selectables>
          <selectable>DTLS 1.0 (RFC 4347)</selectable>
	</selectables>
        as a server that supports the ciphersuites
        <selectables linebreak="yes">
          <selectable>TLS_RSA_WITH_AES_128_CBC_SHA as defined in RFC 5246</selectable>
          <selectable>TLS_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</selectable>
          <selectable>TLS_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</selectable>
          <selectable>TLS_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</selectable>
          <selectable>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5246</selectable>
          <selectable>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 as defined in RFC 5246</selectable>
          <selectable>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5288</selectable>
          <selectable>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 as defined in RFC 5289</selectable>
          <selectable>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 as defined in RFC 5289</selectable>
          </selectables> and no other cipher suites,
          and also supports functionality for
          <selectables linebreak="yes">
            <selectable exclusive="yes">none</selectable>
	    </selectables>.
	</title>
      </f-element>

      <f-element id="f-dtlss-bad-versions">
	<title>The product shall deny connections from clients requesting
        <assignable>list of DTLS protocol versions</assignable>.
	</title>
      </f-element>

      <f-element id="f-dtlss-bad-validation">
	<title>
          The product shall not proceed with a connection handshake attempt if the DTLS Client fails validation.
	</title>
      </f-element>
      <f-element id="f-dtlss-key-size">
	<title>The product shall perform key establishment for DTLS using
        <selectables>
          <selectable>RSA with size
          <selectables>
            <selectable>2048 bits</selectable>
            <selectable>3072 bits</selectable>
          </selectables>
          </selectable>
          <selectable>Diffie-Hellman parameters with size
          <selectables>
            <selectable>2048 bits</selectable>
            <selectable>3072 bits</selectable>
            <selectable>4096 bits</selectable>
            <selectable>6144 bits</selectable>
            <selectable>8192 bits</selectable>
          </selectables>
          </selectable>
          <selectable>Diffie-Hellman groups
          <selectables>
            <selectable>ffdhe2048</selectable>
            <selectable>ffdhe3072</selectable>
            <selectable>ffdhe4096</selectable>
            <selectable>ffdhe6144</selectable>
            <selectable>ffdhe8192</selectable>
            <selectable>no other groups</selectable>
          </selectables>
          </selectable>
          <selectable>ECDHE parameters using elliptic curves
          <selectables>
            <selectable>secp256r1</selectable>
            <selectable>secp384r1</selectable>
            <selectable>secp521r1</selectable>
          </selectables> and no other curves</selectable>
          </selectables>.
	</title>
      </f-element>
      <f-element id="f-dtlss-bad-mac-decrypt">
	<title>The product shall
	<selectables>
          <selectable>terminate the DTLS session</selectable>
          <selectable>silently discard the record</selectable>
	</selectables>
	if a message received contains an invalid MAC or if decryption fails in the case of GCM and other
	AEAD ciphersuites.
	</title>
      </f-element>
    </f-component>
    <f-component cc-id="fcs_dtlss_ext.2" name="DTLS Server Support for Mutual Authentication" status="sel-based">
      <depends on="dtlss_mutual_auth"/>
      <f-element id="f-dtlss-mut-auth">
        <title>
          The product shall support mutual authentication of DTLS clients using X.509v3 certificates.
        </title>
      </f-element>
      <f-element id="f-dtlss-handle-bad-cert">
	<title>The product shall not establish a trusted channel
        if the client certificate is invalid.
	</title>
      </f-element>
      <f-element id="f-dtlss-handle-bad-dn-san">
	<title>The product shall not establish a trusted channel if
        the Distinguished Name (DN) or Subject Alternative Name (SAN)
        contained in a certificate does not match one of the expected identifiers
        for the client.
	</title>
      </f-element>
    </f-component>
  </package>

  <base-pp>
    <git>
      <url>https://github.com/commoncriteria/operatingsystem</url>
      <branch>release-4.3</branch>
      <commit>3566d59e9044a973a9c0a039d014f162fe63e21c</commit>
    </git>
    <f-component cc-id="fcs_ckm.1" name="Cryptographic Key Generation (Refined)">
      <f-element id="fel-asym-gen">
	<title> The <h:b>OS</h:b> shall generate <h:b>asymmetric</h:b> cryptographic keys in accordance with a
	specified cryptographic key generation algorithm <selectables linebreak="yes">
	<selectable id="s-keygen-rsa"><snip>RSA schemes</snip> using cryptographic key sizes of 3072-bit or greater that
	meet the following: FIPS PUB 186-4, "Digital Signature Standard (DSS)", Appendix B.3
	</selectable>
	<selectable id="s-keygen-ecc"><snip>ECC schemes using "NIST curves"</snip> P-384 and
	<selectables>
          <selectable>P-521</selectable>
          </selectables> that meet the following: FIPS PUB 186-4, "Digital Signature Standard (DSS)",
          Appendix B.4
	</selectable>
	<selectable id="s-keygen-ffc">
	  <snip>FFC schemes</snip> using 
	  <selectables>
	    <selectable id="s-keygen-ffc-fips">cryptographic key sizes of 3072-bit
            or greater that meet the following: <snip>FIPS PUB 186-4</snip>, "Digital Signature
            Standard (DSS)", Appendix B.1</selectable>
	    <!-- <selectable id="s-keygen-ffc-dh"><snip>Diffie-Hellman Group 14</snip> that meet the following: RFC 3526 </selectable> -->
	    <selectable id="s-keygen-ffc-safeprime"><snip>safe primes</snip> that meet the following: 
	    NIST Special Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key Establishment Schemes"
	  </selectable>
	</selectables>
      </selectable>
      </selectables>.
    </title>
  </f-element>
</f-component>

<f-component cc-id="ftp_itc_ext.1" name="Trusted channel communication">
  <f-element id="fel-trust-comms">
    <title>
      The OS shall use
      <selectables linebreak='yes'>
        <selectable id="tls">
	  <snip>TLS</snip> as conforming to the <xref to="pkg-tls"/> as a
    	  <selectables><selectable id="s-tls-client"><readable>client(TLS)</readable>client</selectable><selectable id="s-tls-server"><readable>server(TLS)</readable>server</selectable></selectables>
	</selectable>
        <selectable id="dtls"><snip>DTLS</snip> as conforming to the <xref to="pkg-tls"/> as a
    	<selectables><selectable id="s-dtls-client"><readable>client(DTLS)</readable>client</selectable><selectable id="s-dtls-server"><readable>server(DTLS)</readable>server</selectable></selectables>
      </selectable>

    </selectables>
    to provide a trusted communication channel between itself and
    authorized IT entities supporting the following capabilities:
    <selectables>
      <selectable>audit server</selectable>
      <selectable>authentication server</selectable>
      <selectable>management server</selectable>
      <selectable><assignable>other capabilities</assignable></selectable>
    </selectables>
    that is logically distinct from other communication
    channels and provides assured identification of its end points and protection of the channel
    data from disclosure and detection of modification of the channel data.
  </title>
</f-element>
</f-component>

<f-component cc-id="fcs_ckm.2" name="Cryptographic Key Establishment (Refined)">
  <f-element id="fel-crypt-key-estab">
    <title>The OS shall <h:b>implement functionality to perform cryptographic key establishment</h:b>
    in accordance with a specified cryptographic key <h:b>establishment</h:b> method:
    <selectables linebreak="yes">
      <selectable id="s-keyestab-rsa"><snip>RSA-based</snip> key establishment schemes that meets the following:
      RSAES-PKCS1-v1_5 as specified in Section 7.2 of RFC 8017, “Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.2"</selectable>
      
      <selectable id="s-keyestab-ecc"><snip>Elliptic curve-based</snip> key establishment schemes that meets the following: NIST Special Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography”</selectable>
      <selectable id="s-keyestab-ffc"><snip>Finite field-based</snip> key establishment schemes
      that meets <snip>NIST Special Publication 800-56A</snip> Revision 3, “Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography”</selectable>
      <!-- <selectable id="s-keyestab-dh">using <snip>Diffie-Hellman</snip> group 14 that meets the following: RFC 3526</selectable> -->
      </selectables>.
    </title>
    

    <rule id="r-key-rsa">
      <if><ref-id>s-keyestab-rsa</ref-id></if>
      <then><ref-id>s-keygen-rsa</ref-id></then>
    </rule>
    <rule id="r-key-ecc">
      <if><ref-id>s-keyestab-ecc</ref-id></if>
      <then><ref-id>s-keygen-ecc</ref-id></then>
    </rule>
    <rule id="r-key-ffc">
      <if><ref-id>s-keyestab-ffc</ref-id></if>
      <then><ref-id>s-keygen-ffc</ref-id></then>
    </rule>
    
  </f-element>
</f-component>

<ext-comp-def fam-id="FCS_CKM_EXT" title="Cryptographic Key Handling">
  <fam-behavior>This family defines requirements for handling cryptographic keys.</fam-behavior>
</ext-comp-def>

<f-component cc-id="fcs_ckm_ext.4" name="Cryptographic Key Destruction" >
  <f-element id="fel-key-kill">
    <title>
      The OS shall destroy cryptographic keys and key material in accordance with a specified cryptographic key destruction method
      <selectables>
	<selectable>For volatile memory, the destruction shall be executed by a
	<selectables>
	  <selectable>single overwrite consisting of <selectables>
<selectable>a pseudo-random pattern using the TSF&apos;s RBG</selectable>
<selectable>zeroes</selectable>
<selectable>ones</selectable>
<selectable>a new value of a key</selectable>
<selectable><assignable> any value that does not contain any CSP</assignable></selectable></selectables></selectable>
<selectable>removal of power to the memory</selectable>
<selectable>destruction of reference to the key directly followed by a request for garbage collection</selectable>
</selectables></selectable>
<selectable>For non-volatile memory that consists of 
<selectables>
  <selectable id="s-kek-kill"><snip>destruction
  of all key encrypting keys (KEKs) protecting the target key
  according to <xref to="fel-key-kill"/></snip>, where none of the KEKs protecting the target key are derived
</selectable>
<selectable>the invocation of an interface provided by the underlying platform that
<selectables>
  <selectable>logically addresses the storage location of the key and performs a 
  <selectables>
<selectable>single</selectable>
<selectable><assignable>ST author defined multi-pass</assignable></selectable>
</selectables>overwrite consisting of
<selectables>
<selectable>zeroes</selectable><selectable>ones</selectable>
<selectable>pseudo-random pattern</selectable>
<selectable>a new value of a key of the same size</selectable>
<selectable><assignable>any value that does not contain any CSP</assignable></selectable></selectables></selectable>
<selectable>instructs the underlying platform to destroy the abstraction that represents the key</selectable>
</selectables>
</selectable>
</selectables>
</selectable>
</selectables>
.
</title>

</f-element>
<f-element id="fel-key-kill-when">
<title>The OS shall destroy all keys and key material when no longer needed.</title>


</f-element>
</f-component>

<f-component cc-id="fcs_cop.1" iteration="ENCRYPT" name="Cryptographic Operation - Encryption/Decryption (Refined)">
  <f-element id="fel-encrypt-how">
    <title>
      The <h:b>OS</h:b> shall perform [<h:i>encryption/decryption services for data</h:i>] in
      accordance with a specified cryptographic algorithm<h:b>
      <selectables linebreak="yes">
<selectable id="s-aes-xts"><snip>AES-XTS</snip> (as defined in NIST SP 800-38E)</selectable>
<selectable id="s-aes-cbc"><snip>AES-CBC</snip> (as defined in NIST SP 800-38A)</selectable>
<selectable id="s-aes-ctr"><snip>AES-CTR</snip> (as defined in NIST SP 800-38A)</selectable>
</selectables>
and
<selectables linebreak="yes">
  <!-- <selectable>AES-CCMP (as defined in FIPS PUB 197, NIST SP 800-38C and IEEE 802.11-2012)</selectable> -->
<selectable id="s-aes-kw">AES Key Wrap (KW) (as defined in NIST SP 800-38F)</selectable>
<selectable id="s-aes-kwp">AES Key Wrap with Padding (KWP) (as defined in NIST SP 800-38F)</selectable>
<!-- <selectable>AES-GCM (as defined in NIST SP 800-38D)</selectable> -->
<!-- <selectable>AES-CCM (as defined in NIST SP 800-38C)</selectable> -->
<selectable id="s-aes-ccmp"><snip>AES-CCMP-256</snip> (as defined in NIST SP 800-38C and IEEE 802.11ac-2013)</selectable>
<selectable id="s-aes-gcmp"><snip>AES-GCMP-256</snip> (as defined in NIST SP 800-38D and IEEE 802.11ac-2013)</selectable>

<!-- <depends on="s-ftp_ssh"/> Could have added this to the previous, but choose to use rules.-->

</selectables></h:b>
and cryptographic key sizes 256-bit.
<!-- <selectables> -->
<!--   <selectable>128-bit</selectable> -->
<!--   <selectable>256-bit</selectable> -->
<!-- </selectables> -->
<h:strike>that meet the following: [assignment: list of standards]</h:strike>.
</title>


<rule id="r-wlan-aes">
  <or>
<and><not><ref-id>mod-wlanclient</ref-id></not></and>
<and>
<ref-id>mod-wlanclient</ref-id>
<or><ref-id>s-aes-ccmp</ref-id><ref-id>s-aes-gcmp</ref-id></or>
</and>
</or>
</rule>
<!-- <rule id="r-aes-ctr-for-ssh"> -->
<!--   <if><ref-id>s-ftp_ssh</ref-id></if> -->
<!--   <then><ref-id>s-aes-ctr</ref-id></then> -->
<!-- <or><and><ref-id>s-aes-ctr</ref-id><ref-id>s-ftp_ssh</ref-id></and> -->
<!-- <not><ref-id>s-ftp_ssh</ref-id></not> -->
<!-- </or> -->
<!-- </rule> -->
</f-element>
</f-component>
<f-component cc-id="fcs_cop.1" iteration="HASH" name="Cryptographic Operation - Hashing (Refined)">
  <f-element id="fel-hash-how">
    <title>The <h:b>OS</h:b> shall perform [<h:i>cryptographic hashing services</h:i>] in accordance with a
    specified cryptographic algorithm <h:b>
    <selectables linebreak="yes">
<selectable>SHA-256</selectable>
<selectable>SHA-384</selectable>
<selectable>SHA-512</selectable>
</selectables>
and message digest sizes
<selectables linebreak="yes">
<selectable>160 bits</selectable>
<selectable>256 bits</selectable>
<selectable>384 bits</selectable>
<selectable>512 bits</selectable>
</selectables></h:b> that meet the following: [<h:i>FIPS Pub 180-4</h:i>]. </title>


</f-element>
</f-component>
<f-component cc-id="fcs_cop.1" iteration="SIGN" name="Cryptographic Operation - Signing (Refined)">
  <f-element id="fel-sign-how">
    <title>The <h:b>OS</h:b> shall perform [<h:i>cryptographic signature services (generation and
    verification)</h:i>] in accordance with a specified cryptographic algorithm <h:b><selectables
    linebreak="yes">
    <selectable id="s-rsa-certs">RSA schemes using cryptographic key sizes of 2048-bit or greater
that meet the following: FIPS PUB 186-4, "Digital Signature Standard (DSS)",  Section 4</selectable>
<selectable id="s-ec-certs"><snip>ECDSA schemes</snip> using "NIST curves" P-384 and <selectables>
<selectable>P-521</selectable>
</selectables>
that meet the following: FIPS PUB 186-4, "Digital Signature   Standard (DSS)", Section 5</selectable>
</selectables></h:b>
<h:strike>and cryptographic key sizes [assignment: cryptographic algorithm]
that meet the following: [assignment: list of standards]</h:strike>.
</title>


</f-element>
</f-component>
<f-component cc-id="fcs_cop.1" iteration="KEYHMAC" name="Cryptographic Operation - Keyed-Hash Message Authentication (Refined)">
  <f-element id="fel-keyed-hash-how">
    <title>The <h:b>OS</h:b> shall perform [<h:i>keyed-hash message authentication services</h:i>]
    in accordance with a specified cryptographic algorithm<h:b>
    <selectables>
<selectable>SHA-256</selectable>
<selectable>SHA-384</selectable>
<selectable>SHA-512</selectable>
</selectables>
with key sizes <assignable>key size (in bits) used in HMAC</assignable>
and message digest</h:b> sizes
<selectables>
  <selectable>160 bits</selectable>
<selectable>256 bits</selectable>
<selectable>384 bits</selectable>
<selectable>512 bits</selectable>
</selectables> that meet the following: [<h:i>FIPS Pub 198-1 The Keyed-Hash Message
Authentication Code and FIPS Pub 180-4 Secure Hash Standard</h:i>]. </title>


</f-element>
</f-component>

<ext-comp-def fam-id="FCS_RBG_EXT" title="Random Bit Generation Services">
<fam-behavior>This family defines requirements for generating random bits</fam-behavior>
</ext-comp-def>

<f-component cc-id="fcs_rbg_ext.1" name="Random Bit Generation">
  <f-element id="fel-rbg-how">
    <title>
      The OS shall perform all deterministic random bit generation (DRBG) services in
      accordance with NIST Special Publication 800-90A using
      <selectables linebreak="yes">
<selectable>Hash_DRBG (any)</selectable>
<selectable>HMAC_DRBG (any)</selectable>
<selectable>CTR_DRBG (AES)</selectable>
</selectables>
.
</title>


</f-element>

<f-element id="fel-rbg-seed-how">
  <title>
    The deterministic RBG used by the OS shall be seeded by an entropy source that
    accumulates entropy from a
    <selectables linebreak="yes">
<selectable>software-based noise source</selectable>
<selectable>platform-based noise source</selectable>
</selectables>
with a minimum of 256 bits
<!-- <selectables linebreak="yes"> -->
<!--   <selectable>128 bits</selectable> -->
<!--   <selectable>256 bits</selectable> -->
<!-- </selectables> -->
of entropy at least equal to the greatest security strength (according to NIST SP 800-57)
of the keys and hashes that it will generate.
</title>


</f-element>
</f-component>

<ext-comp-def fam-id="FCS_STO_EXT" title="Storage of Special Data">
<fam-behavior>This family defines requirements concerning the storage of certain types of data.</fam-behavior>
</ext-comp-def>

<f-component cc-id="fcs_sto_ext.1" name="Storage of Sensitive Data">
  <f-element id="fel-store-sdata">
    <title>
      The OS shall implement functionality to encrypt sensitive data
      stored in non-volatile storage and provide interfaces to applications to invoke this functionality.
    </title>
    

  </f-element>
</f-component>

<section title="User Data Protection (FDP)" id="fdp">
  <ext-comp-def title="Access Controls for User Data" fam-id="FDP_ACF_EXT">
<fam-behavior>This family defines requirements for controlling access to user data.</fam-behavior>
</ext-comp-def>
<f-component cc-id="fdp_acf_ext.1" name="Access Controls for Protecting User Data">
  <f-element id="fel-protect-user-data">
    <title>
      The OS shall implement access controls which can prohibit unprivileged users from
      accessing files and directories owned by other users.
</title>


</f-element>
</f-component>

<ext-comp-def fam-id="FDP_IFC_EXT" title="Information flow control">
  <fam-behavior>This family of requirements defines how flows of information are controlled.</fam-behavior>
</ext-comp-def>

<f-component cc-id="fdp_ifc_ext.1" name="Information flow control" status="sel-based">
  <depends on="s-itc-ipsec"/>
<depends><optional/></depends>
<f-element id="fel-dit-vpn">
  <title> The OS shall
  <selectables linebreak="yes">
<selectable>provide an interface which allows a VPN client to protect all IP traffic using IPsec</selectable>
<selectable id="s-provides-vpnclient"><snip>provide a VPN client</snip> that can protect all IP traffic using IPsec</selectable>
</selectables>
with the exception of IP traffic required to establish the VPN connection
and
<selectables>
<selectable>signed updates directly from the OS vendor</selectable>
</selectables>
.
</title>


</f-element>
</f-component>
</section>
<section title="Security Management (FMT)" id="fmt">
  <ext-comp-def fam-id="FMT_MOF_EXT" title="Management of security functions behavior">
<fam-behavior>This family of requirements define the behavior of security function management.</fam-behavior>
</ext-comp-def>
<f-component cc-id="fmt_mof_ext.1" name="Management of security functions behavior">
  <f-element id="fel-man-sec-func">
    <title>
      The OS shall restrict the ability to perform the function indicated in the "Administrator" column in 
      <xref to="fel-manage-functions"/> to the administrator.
</title>


</f-element>
</f-component>

<ext-comp-def fam-id="FMT_SMF_EXT" title="Specification of Management Functions">
<fam-behavior>This family of requirements defines the management of security functions. </fam-behavior>
</ext-comp-def>
<f-component cc-id="fmt_smf_ext.1" name="Specification of Management Functions">
  <f-element id="fel-manage-functions">
    <title>
      The OS shall be capable of performing the following management functions:
      <h:br/>
      <management-function-set default="O">
	<manager cid="a">Administrator</manager>
<manager cid="u">User</manager>
<management-function><text>Enable/disable <selectables><selectable>screen lock</selectable><selectable>session timeout</selectable></selectables></text><M ref="a"/></management-function>
<management-function><text>Configure <selectables><selectable>screen lock</selectable><selectable>session</selectable></selectables> inactivity timeout</text><M ref="a"/></management-function>
<management-function><text>import keys/secrets into  the secure key storage</text></management-function>
<management-function><text>Configure local audit storage capacity</text></management-function>
<management-function><text>Configure minimum password length</text></management-function>
<management-function><text>Configure minimum number of special characters in password</text></management-function>
<management-function><text>Configure minimum number of numeric characters in password</text></management-function>
<management-function><text>Configure minimum number of uppercase characters in password</text></management-function>
<management-function><text>Configure minimum number of lowercase characters in password</text></management-function>
<management-function><text>
  Configure lockout policy for unsuccessful authentication attempts through
  <selectables>
<selectable>timeouts between attempts</selectable>
<selectable>limiting number of attempts during a time period</selectable>
</selectables>
</text></management-function>
<management-function><text>Configure host-based firewall</text></management-function>
<management-function><text>Configure name/address of directory server with which to bind</text></management-function>
<management-function><text>Configure name/address of remote management server from which to receive management settings</text></management-function>
<management-function><text>Configure name/address of audit/logging server to which to send audit/logging records</text></management-function>
<management-function><text>Configure audit rules</text></management-function>
<management-function><text>Configure name/address of network time server</text></management-function>
<management-function><text>Enable/disable automatic software update</text></management-function>
<management-function><text>Configure Wi-Fi interface</text></management-function>
<management-function><text>Enable/disable Bluetooth interface</text></management-function>
<management-function><text>Enable/disable <assignable> list of other external interfaces</assignable></text></management-function>
<management-function><text><assignable>list of other management functions to be provided by the TSF</assignable></text></management-function>
</management-function-set>
.
</title>


</f-element>
</f-component>
</section>
<section title="Protection of the TSF (FPT)" id="fpt">

  <ext-comp-def fam-id="FPT_ACF_EXT" title="Access controls">
    <fam-behavior>This family of requirements defines the access controls to system resources. </fam-behavior>
  </ext-comp-def>
  
  <f-component cc-id="fpt_acf_ext.1" name="Access controls">
    <f-element id="fel-protect-priv">
      <title> The OS shall implement access controls which prohibit unprivileged users from
      modifying: <h:ul>
      <h:li>Kernel and its drivers/modules</h:li>
      <h:li>Security audit logs</h:li>
      <h:li>Shared libraries</h:li>
      <h:li>System executables</h:li>
<h:li>System configuration files</h:li>
<h:li><assignable>other objects</assignable></h:li>
</h:ul>
.
</title>

</f-element>
<f-element id="fel-no-read">
  <title> The OS shall implement access controls which prohibit unprivileged users from
  reading: <h:ul>
  <h:li>Security audit logs</h:li>
  <h:li>System-wide credential repositories</h:li>
  <h:li><assignable>list of other objects</assignable></h:li>
</h:ul>
.
</title>


</f-element>
</f-component>

<ext-comp-def fam-id="FPT_ASLR_EXT" title="Address Space Layout Randomization">
  <fam-behavior>This family of requirements defines the behavior of ASLR.</fam-behavior>
</ext-comp-def>

<f-component cc-id="fpt_aslr_ext.1" name="Address Space Layout Randomization">
  <f-element id="fel-aslr">
    <title>The OS shall always randomize process address space memory locations with
    <selectables>
<selectable>8</selectable>
<selectable><assignable>number greater than 8</assignable></selectable>
</selectables>
bits of entropy except for
<assignable>list of explicit exceptions</assignable>.
</title>

</f-element>
</f-component>

<ext-comp-def fam-id="FPT_BLT_EXT" title="Limitation of Bluetooth Profile Support">
<fam-behavior>This family defines requirements for limiting Bluetooth capabilities without user action.</fam-behavior>
</ext-comp-def>

<f-component cc-id="fpt_blt_ext.1" name="Limitation of Bluetooth Profile Support" status="objective">
<comp-lev> requires the TSF to maintain a disabled by default posture for Bluetooth profiles.</comp-lev>
<management>There are no management activities foreseen.</management>
<audit>There are no auditable events foreseen.</audit>
<dependencies>No dependencies.</dependencies>


<f-element id="fel-bluetooth-stop">
  <title>
    The TSF shall disable support for
<assignable>list of Bluetooth profiles</assignable>
Bluetooth profiles when they are not currently being used by
an application on the TOE and shall require explicit user action to enable
them.
</title>


</f-element>
</f-component>


<ext-comp-def fam-id="FPT_SBOP_EXT" title="Stack Buffer Overflow Protection">
<fam-behavior>This family of requirements defines the protections for the stack.</fam-behavior>
</ext-comp-def>

<f-component cc-id="fpt_sbop_ext.1" name="Stack Buffer Overflow Protection">
  <f-element id="fel-sbop">
    <title>
      The OS shall <selectables>
<selectable>employ stack-based buffer overflow protections</selectable>
<selectable>not store parameters/variables in the same data structures as control flow values</selectable>
</selectables>.
</title>



</f-element>
</f-component>

<ext-comp-def fam-id="FPT_SRP_EXT" title="Software Restriction Policies">
<fam-behavior>This family of requirements defines how access to executes is restricted.</fam-behavior>
</ext-comp-def>

<f-component cc-id="fpt_srp_ext.1" name="Software Restriction Policies" status="objective">
  <f-element id="fel-srp">
    <title> The OS shall restrict execution to only programs which match an administrator-specified
    <selectables linebreak="yes">
<selectable id="s-srp-path">file path</selectable>
<selectable id="s-srp-signature">file digital signature</selectable>
<selectable id="s-srp-version">version</selectable>
<selectable id="s-srp-hash">hash</selectable>
<selectable id="s-srp-other"><readable>other</readable><assignable>other characteristics</assignable></selectable>
</selectables>
.
</title>


</f-element>
</f-component>

<ext-comp-def fam-id="FPT_TST_EXT" title="Integrity Tests">
<fam-behavior>This family of requirements defines how the TOE validates the integrity of critical components. </fam-behavior>
</ext-comp-def>
<f-component cc-id="fpt_tst_ext.1" name="Boot Integrity">
  <f-element id="fel-boot">
    <title>The OS shall verify the integrity of the bootchain up through the OS kernel and
    <selectables linebreak="yes">
<selectable id="s-verify-all-code">all executable code stored in mutable media</selectable>
<selectable><assignable>list of other executable code</assignable></selectable>
</selectables>
prior to its execution through the use of
<selectables linebreak="yes">
<selectable>a digital signature using a hardware-protected asymmetric key</selectable>
<selectable id="s-boot-x509">a digital signature using an X509 certificate with hardware-based protection</selectable>
<selectable>a hardware-protected hash</selectable>
</selectables>
.
</title>


</f-element>
</f-component>

<ext-comp-def fam-id="FPT_TUD_EXT" title="Trusted Update">
<fam-behavior>This family of requirements defines how the TOE validates software updates.</fam-behavior>
</ext-comp-def>

<f-component cc-id="fpt_tud_ext.1" name="Trusted Update">
  <f-element id="fel-os-update">
    <title>The OS shall provide the ability to check for updates to the OS
software itself and shall use a digital signature scheme specified in FCS_COP.1/SIGN to validate the authenticity of the response. </title>


</f-element>
<f-element id="fel-verify-updates">
  <title>
    The OS shall 
    <selectables>
<selectable>cryptographically verify</selectable>
<selectable>invoke platform-provided functionality to cryptographically verify</selectable>
</selectables>
updates to itself using a digital
signature prior to installation using schemes specified in FCS_COP.1/SIGN.
</title>


</f-element>
</f-component>
<f-component cc-id="fpt_tud_ext.2" name="Trusted Update for Application Software">
  <!-- TO DO: Cite references. -->
  <f-element id="fel-app-check-update">
    <title>
      The OS shall provide the ability to check for updates to
      application software and shall use a digital signature scheme specified in 
      FCS_COP.1/SIGN to validate the authenticity of the response.
    </title>
    

  </f-element>
  <f-element id="fel-verify-app-updates">
    <title>
      The OS shall cryptographically verify the integrity of updates
      to applications using a digital signature specified by
      FCS_COP.1/SIGN prior to installation.
</title>

</f-element>
</f-component>


<ext-comp-def fam-id="FPT_W^X_EXT" title="Write XOR Execute">
  <fam-behavior>
    This family of requirements defines how the TOE ensures that it executes only those items that are non-writable with specified exceptions.
  </fam-behavior>
</ext-comp-def>
<f-component cc-id="fpt_w^x_ext.1" name="Write XOR Execute Memory Pages">
  <f-element id="fel-no-rw-mem">
    <title> The OS shall prevent allocation of any memory region with both write and
    execute permissions except for <assignable>list of exceptions</assignable>.
</title>


</f-element>
</f-component>
</section>
<section title="Audit Data Generation (FAU)" id="fau">
  <f-component cc-id="fau_gen.1" name="Audit Data Generation (Refined)">
    <f-element id="fel-faugen">
      <title>
	The <h:b>OS</h:b> shall be able to generate an audit record of the following auditable
        events:
        <h:ol type='a'>
<h:li>Start-up and shut-down of the audit functions;</h:li>
<h:li>All auditable events for the [<h:i>not specified</h:i>] level of audit; and [</h:li>
<h:li><h:i>
  <h:ul><h:li>Authentication events (Success/Failure);</h:li>
  <h:li>Use of privileged/special rights events (Successful and unsuccessful security, audit, and configuration changes);</h:li>
<h:li>Privilege or role escalation events (Success/Failure);</h:li>
<h:li><selectables linebreak='yes'>
<selectable>File and object events (Successful and unsuccessful attempts to create, access, delete, modify, modify permissions)</selectable>
<selectable>User and Group management events (Successful and unsuccessful add, delete, modify, disable, enable, and credential change)</selectable>
<selectable>Audit and log data access events (Success/Failure)</selectable>
<selectable>Cryptographic verification of software (Success/Failure)</selectable>
<selectable>Attempted application invocation with arguments (Success/Failure e.g. due to software restriction policy)</selectable>
<selectable>System reboot, restart, and shutdown events (Success/Failure)</selectable>
<selectable>Kernel module loading and unloading events (Success/Failure)</selectable>
<selectable>Administrator or root-level access events (Success/Failure)</selectable>
<selectable><assignable>other specifically defined auditable events</assignable>.</selectable>
</selectables>
</h:li>
</h:ul>
</h:i>].
</h:li>
</h:ol>
</title>

</f-element>
<f-element id="fel-audit-content">
  <title> The <h:b>OS</h:b> shall record within each audit record at least the following information:
  <h:ol type='a'>
    <h:li>Date and time of the event, type of event, subject identity (if applicable),
    and outcome (success or failure) of the event; and </h:li>
    <h:li>For each audit event type, based on the auditable event
    definitions of the functional components included in the PP/ST,
<assignable>other audit relevant information</assignable>
</h:li>
</h:ol>
.
</title>


</f-element>
</f-component>
</section>
<section title="Identification and Authentication (FIA)" id="fia">
  <f-component cc-id="fia_afl.1" name="Authentication failure handling (Refined)">
    <f-element id="fel-id-and-auth">
      <title>
        The <h:b>OS</h:b> shall detect when
        <selectables linebreak='yes'>
<selectable><assignable>positive integer number</assignable></selectable>
<selectable>an administrator configurable positive integer within <assignable>range of acceptable values</assignable></selectable>
</selectables>
unsuccessful authentication attempts occur related to
<h:b>
  events with
  <selectables linebreak="yes">
<selectable>authentication based on user name and password</selectable>
<selectable>authentication based on user name and a PIN that
releases an asymmetric key stored in OE-protected storage</selectable>
<selectable>authentication based on X.509 certificates</selectable>
</selectables>
</h:b>.
</title>

</f-element>
<f-element id="fel-bad-attempts">
  <title>
    When the defined number of unsuccessful authentication attempts for an
    account has been <h:b>met</h:b>, the <h:b>OS</h:b> shall:
    <h:b>
      <selectables>
<selectable>Account Lockout</selectable>
<selectable>Account Disablement</selectable>
<selectable>Mandatory Credential Reset</selectable>
<selectable><assignable>list of actions</assignable></selectable>
</selectables>
</h:b>.
</title>


</f-element>
</f-component>
<f-component cc-id="fia_uau.5" name="Multiple Authentication Mechanisms (Refined)">
  <f-element id="fel-mult-auth">
    <title>
      The <refinement>OS</refinement> shall provide the following authentication mechanisms
      <h:b><selectables linebreak='yes'>
	<selectable id="s-pass">authentication based on username and password</selectable>
	<selectable id="s-pin">authentication based on <snip>username and a PIN that releases an asymmetric key</snip> stored
in OE-protected storage</selectable>
<selectable id="s-otp">combination of authentication based on user name, password, and time-based one-time password</selectable>
<selectable id="s-x509-auth">authentication based on X.509 certificates</selectable>
<selectable id="s-uau-ssh">for use in SSH only, <snip>SSH public key-based authentication</snip> as specified by the <xref to="pkg-ssh"/></selectable>
</selectables>
</h:b>
to support user authentication.
</title>


</f-element>
<f-element id="fel-auth-how">
  <title>
    The <h:b>OS</h:b> shall authenticate any user's claimed identity according to the
    <assignable>
      rules describing how the multiple authentication
      mechanisms provide authentication
      </assignable>.
</title>


</f-element>
</f-component>


<ext-comp-def fam-id="FIA_X509_EXT" title="X.509 Certificate Validation">
<fam-behavior>This family of requirements defines how the X.509 performs validation and what they should be used for.</fam-behavior>
</ext-comp-def>

<f-component cc-id="fia_x509_ext.1" id="fc-cert-val" name="X.509 Certificate Validation">
  <f-element id="fel-cert-val">
    <title>
      The OS shall implement functionality to validate certificates in accordance with the following rules:
      <h:ul>
<h:li>RFC 5280 certificate validation and certificate path validation</h:li>
<h:li>The certificate path must terminate with a trusted CA certificate</h:li>
<h:li>The OS shall validate a certificate path by ensuring the presence of the 
basicConstraints extension, that the CA flag is set to TRUE for all CA certificates,
and that any path constraints are met.</h:li>
<h:li>The TSF shall validate that any CA certificate includes "Certificate Signing" as a  purpose the key usage field</h:li>

<h:li>The OS shall validate the revocation status of the certificate using 
<selectables>
<selectable>OCSP as specified in RFC 6960</selectable>
<selectable>CRL as specified in RFC 8603</selectable>
<selectable>an OCSP TLS Status Request Extension (OCSP stapling) as specified
in RFC 6066</selectable>
<selectable> OCSP TLS Multi-Certificate Status Request Extension 
(i.e., OCSP Multi-Stapling) as specified in RFC 6961</selectable>
</selectables>
with
<selectables><selectable>no exceptions</selectable>
<selectable id="s-revoc-exceptions"><readable>exceptional use cases</readable><assignable>exceptional use cases and alternative status check</assignable></selectable></selectables></h:li>

<h:li>The OS shall validate the extendedKeyUsage field according to the following rules:
<h:ul>

<h:li> Certificates used for trusted updates and executable code integrity verification shall have the Code Signing Purpose (id-kp 3 with OID 1.3.6.1.5.5.7.3.3) in the extendedKeyUsage field.</h:li>
<h:li>Server certificates presented for TLS shall have the Server Authentication purpose (id-kp 1 with OID 1.3.6.1.5.5.7.3.1) in the extendedKeyUsage field.</h:li>	
<h:li>Client certificates presented for TLS shall have the Client Authentication purpose (id-kp 2 with OID 1.3.6.1.5.5.7.3.2) in the EKU field.</h:li>
<h:li>S/MIME certificates presented for email encryption and signature shall have the Email Protection purpose (id-kp 4 with OID 1.3.6.1.5.5.7.3.4) in the EKU field.</h:li>
<h:li>OCSP certificates presented for OCSP responses shall have the OCSP Signing Purpose (id-kp 9 with OID 1.3.6.1.5.5.7.3.9) in the EKU field.</h:li>
<h:li>Server certificates presented for EST shall have the CMC Registration Authority (RA) purpose (id-kp-cmcRA with OID 1.3.6.1.5.5.7.3.28) in the EKU field. (conditional)</h:li>
</h:ul>
</h:li>
</h:ul>				
.
</title>


</f-element>
<f-element id="fel-cacert">
  <title>
    The OS shall only treat a certificate as a CA certificate if the
    <h:i>basicConstraints</h:i> extension is present and the CA flag is set to TRUE.
</title>


</f-element>
</f-component>
<f-component cc-id="fia_x509_ext.2" name="X.509 Certificate Authentication">
  <f-element id="fel-cert-auth">
    <title> The OS shall use X.509v3 certificates as defined by RFC 5280 to support
    authentication for TLS and
    <selectables>
<selectable>DTLS</selectable>
<selectable>HTTPS</selectable>
<selectable><assignable>other protocols</assignable></selectable>
</selectables>
connections.
</title>

</f-element>
</f-component>
</section>
<section title="TOE Access (FTA)" id="fta">
  <f-component cc-id="fta_tab.1" name="Default TOE access banners" status="optional">
    <f-element id="fel-banner">
      <title>
        Before establishing a user session, the <h:b>OS</h:b> shall display an advisory
        warning message regarding unauthorized use of the OS.
</title>

</f-element>
</f-component>
</section>
<section title="Trusted Path/Channels (FTP)" id="ftp">


  <f-component cc-id="ftp_trp.1" name="Trusted Path">
    <f-element id="fel-trust-ends">
      <title>
	The <h:b>OS</h:b> shall provide a communication path between itself and
	<selectables><selectable id="s-remote">remote</selectable><selectable id="s-local">local</selectable></selectables>
	users that is logically distinct from other communication paths and provides assured
	identification of its endpoints and protection of the communicated data from
	[modification, disclosure].
</title>

</f-element>
<f-element id="fel-trust-users">
  <title> The <h:b>OS</h:b> shall permit
  <selectables>
<selectable>the TSF</selectable>
<selectable>local users</selectable>
<selectable>remote users</selectable>
</selectables>
to initiate communication via the trusted path.
</title>
</f-element>
<f-element id="fel-trust-path">
  <title> The <h:b>OS</h:b> shall require use of the trusted path for
  [[<h:i>all remote administrative actions</h:i>]].
</title>


</f-element>
</f-component>
</section>
</base-pp>
</st>
